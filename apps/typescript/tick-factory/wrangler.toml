name = "tick-factory"
main = "src/ingestindex.ts"
compatibility_date = "2026-01-08"
account_id = "513f37da8020ee565269c199ff8bb52f"

# Note: Each environment must explicitly define its own vars
# Top-level vars are NOT inherited by environments

[env.dev]
name = "tick-factory-dev"
triggers = { crons = ["*/1 * * * *"] }

[env.dev.vars]
JOB_NAME = "tick_factory_ingest_massive_ab"
MAX_ASSETS_PER_RUN = "4"
REQUEST_TIMEOUT_MS = "30000"
LOCK_LEASE_SECONDS = "150"
ASSET_ACTIVE_FIELD = "test_active"
MAX_RUN_BUDGET_MS = "85000"
HARD_DISABLE_STREAK = "2"
FETCH_COOLDOWN_SECONDS = "120"
ALLOWED_PROVIDER_HOSTS = "api.massive.com"
LOG_LEVEL = "INFO"
PROGRESS_INTERVAL = "10"

[env.test]
name = "tick-factory-test"
triggers = { crons = ["*/1 * * * *"] }

[env.test.vars]
JOB_NAME = "tick_factory_ingest_massive_ab"
MAX_ASSETS_PER_RUN = "4"
REQUEST_TIMEOUT_MS = "30000"
LOCK_LEASE_SECONDS = "150"
ASSET_ACTIVE_FIELD = "test_active"
MAX_RUN_BUDGET_MS = "85000"
HARD_DISABLE_STREAK = "2"
FETCH_COOLDOWN_SECONDS = "120"
ALLOWED_PROVIDER_HOSTS = "api.massive.com"
LOG_LEVEL = "INFO"
PROGRESS_INTERVAL = "10"

[env.stage]
name = "tick-factory-stage"
triggers = { crons = ["*/1 * * * *"] }

[env.stage.vars]
JOB_NAME = "tick_factory_ingest_massive_ab"
MAX_ASSETS_PER_RUN = "4"
REQUEST_TIMEOUT_MS = "30000"
LOCK_LEASE_SECONDS = "150"
ASSET_ACTIVE_FIELD = "active"
MAX_RUN_BUDGET_MS = "85000"
HARD_DISABLE_STREAK = "2"
FETCH_COOLDOWN_SECONDS = "120"
ALLOWED_PROVIDER_HOSTS = "api.massive.com"
LOG_LEVEL = "INFO"
PROGRESS_INTERVAL = "10"

[env.prod]
name = "tick-factory-prod"
triggers = { crons = ["*/1 * * * *"] }

[env.prod.vars]
JOB_NAME = "tick_factory_ingest_massive_ab"
MAX_ASSETS_PER_RUN = "4"
REQUEST_TIMEOUT_MS = "30000"
LOCK_LEASE_SECONDS = "150"
ASSET_ACTIVE_FIELD = "active"
MAX_RUN_BUDGET_MS = "85000"
HARD_DISABLE_STREAK = "2"
FETCH_COOLDOWN_SECONDS = "120"
ALLOWED_PROVIDER_HOSTS = "api.massive.com"
LOG_LEVEL = "WARN"
PROGRESS_INTERVAL = "20"
